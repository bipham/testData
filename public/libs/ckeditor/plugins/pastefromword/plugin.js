!function(){function a(a,t,o){var e=CKEDITOR.cleanWord;if(e)o();else{var r=CKEDITOR.getUrl(a.config.pasteFromWordCleanupFile||t+"filter/default.js");CKEDITOR.scriptLoader.load(r,o,null,!0)}return!e}CKEDITOR.plugins.add("pastefromword",{requires:"clipboard",lang:"af,ar,az,bg,bn,bs,ca,cs,cy,da,de,de-ch,el,en,en-au,en-ca,en-gb,eo,es,es-mx,et,eu,fa,fi,fo,fr,fr-ca,gl,gu,he,hi,hr,hu,id,is,it,ja,ka,km,ko,ku,lt,lv,mk,mn,ms,nb,nl,no,oc,pl,pt,pt-br,ro,ru,si,sk,sl,sq,sr,sr-latn,sv,th,tr,tt,ug,uk,vi,zh,zh-cn",icons:"pastefromword,pastefromword-rtl",hidpi:!0,init:function(t){var o=0,e=this.path;t.addCommand("pastefromword",{canUndo:!1,async:!0,exec:function(a,t){o=1,a.execCommand("paste",{type:"html",notification:!t||void 0===t.notification||t.notification})}}),t.ui.addButton&&t.ui.addButton("PasteFromWord",{label:t.lang.pastefromword.toolbar,command:"pastefromword",toolbar:"clipboard,50"}),t.on("paste",function(r){var n=r.data,i=(CKEDITOR.plugins.clipboard.isCustomDataTypesSupported?n.dataTransfer.getData("text/html",!0):null)||n.dataValue,l={dataValue:i},s=/(class=\"?Mso|style=(?:\"|\')[^\"]*?\bmso\-|w:WordDocument|<o:\w+>|<\/font>)/,d=/<meta\s*name=(?:\"|\')?generator(?:\"|\')?\s*content=(?:\"|\')?microsoft/gi.test(i)||s.test(i);if(i&&(o||d)&&(!1!==t.fire("pasteFromWord",l)||o)){n.dontFilter=!0;var c=a(t,e,function(){c?t.fire("paste",n):(!t.config.pasteFromWordPromptCleanup||o||confirm(t.lang.pastefromword.confirmCleanup))&&(l.dataValue=CKEDITOR.cleanWord(l.dataValue,t),t.fire("afterPasteFromWord",l),n.dataValue=l.dataValue),o=0});c&&r.cancel()}},null,null,3)}})}();