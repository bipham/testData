CKEDITOR.DIALOG_RESIZE_NONE=0,CKEDITOR.DIALOG_RESIZE_WIDTH=1,CKEDITOR.DIALOG_RESIZE_HEIGHT=2,CKEDITOR.DIALOG_RESIZE_BOTH=3,CKEDITOR.DIALOG_STATE_IDLE=1,CKEDITOR.DIALOG_STATE_BUSY=2,function(){function t(t){return!!this._.tabs[t][0].$.offsetHeight}function e(){for(var e=this._.currentTabId,i=this._.tabIdList.length,n=CKEDITOR.tools.indexOf(this._.tabIdList,e)+i,o=n-1;o>n-i;o--)if(t.call(this,this._.tabIdList[o%i]))return this._.tabIdList[o%i];return null}function i(){for(var e=this._.currentTabId,i=this._.tabIdList.length,n=CKEDITOR.tools.indexOf(this._.tabIdList,e),o=n+1;o<n+i;o++)if(t.call(this,this._.tabIdList[o%i]))return this._.tabIdList[o%i];return null}function n(t,e){for(var i=t.$.getElementsByTagName("input"),n=0,o=i.length;n<o;n++){var s=new CKEDITOR.dom.element(i[n]);"text"==s.getAttribute("type").toLowerCase()&&(e?(s.setAttribute("value",s.getCustomData("fake_value")||""),s.removeCustomData("fake_value")):(s.setCustomData("fake_value",s.getAttribute("value")),s.setAttribute("value","")))}}function o(t,e){var i=this.getInputElement();i&&(t?i.removeAttribute("aria-invalid"):i.setAttribute("aria-invalid",!0)),t||(this.select?this.select():this.focus()),e&&alert(e),this.fire("validated",{valid:t,msg:e})}function s(){var t=this.getInputElement();t&&t.removeAttribute("aria-invalid")}function a(t){var e=CKEDITOR.dom.element.createFromHtml(CKEDITOR.addTemplate("dialog",m).output({id:CKEDITOR.tools.getNextNumber(),editorId:t.id,langDir:t.lang.dir,langCode:t.langCode,editorDialogClass:"cke_editor_"+t.name.replace(/\./g,"\\.")+"_dialog",closeTitle:t.lang.common.close,hidpi:CKEDITOR.env.hidpi?"cke_hidpi":""})),i=e.getChild([0,0,0,0,0]),n=i.getChild(0),o=i.getChild(1);if(t.plugins.clipboard&&CKEDITOR.plugins.clipboard.preventDefaultDropOnElement(i),CKEDITOR.env.ie&&!CKEDITOR.env.quirks&&!CKEDITOR.env.edge){var s="javascript:void(function(){"+encodeURIComponent("document.open();("+CKEDITOR.tools.fixDomain+")();document.close();")+"}())";CKEDITOR.dom.element.createFromHtml('<iframe frameBorder="0" class="cke_iframe_shim" src="'+s+'" tabIndex="-1"></iframe>').appendTo(i.getParent())}return n.unselectable(),o.unselectable(),{element:e,parts:{dialog:e.getChild(0),title:n,close:o,tabs:i.getChild(2),contents:i.getChild([3,0,0,0]),footer:i.getChild([3,0,1,0])}}}function r(t,e,i){this.element=e,this.focusIndex=i,this.tabIndex=0,this.isFocusable=function(){return!e.getAttribute("disabled")&&e.isVisible()},this.focus=function(){t._.currentFocusIndex=this.focusIndex,this.element.focus()},e.on("keydown",function(t){t.data.getKeystroke()in{32:1,13:1}&&this.fire("click")}),e.on("focus",function(){this.fire("mouseover")}),e.on("blur",function(){this.fire("mouseout")})}function l(t){function e(){t.layout()}var i=CKEDITOR.document.getWindow();i.on("resize",e),t.on("hide",function(){i.removeListener("resize",e)})}function d(t,e){this._={dialog:t},CKEDITOR.tools.extend(this,e)}function u(t){function e(e){var i,l,d=t.getSize(),u=CKEDITOR.document.getWindow().getViewPaneSize(),c=e.data.$.screenX,h=e.data.$.screenY,g=c-n.x,f=h-n.y;n={x:c,y:h},o.x+=g,o.y+=f,i=o.x+r[3]<a?-r[3]:o.x-r[1]>u.width-d.width-a?u.width-d.width+("rtl"==s.lang.dir?0:r[1]):o.x,l=o.y+r[0]<a?-r[0]:o.y-r[2]>u.height-d.height-a?u.height-d.height+r[2]:o.y,t.move(i,l,1),e.data.preventDefault()}function i(){if(CKEDITOR.document.removeListener("mousemove",e),CKEDITOR.document.removeListener("mouseup",i),CKEDITOR.env.ie6Compat){var t=b.getChild(0).getFrameDocument();t.removeListener("mousemove",e),t.removeListener("mouseup",i)}}var n=null,o=null,s=t.getParentEditor(),a=s.config.dialog_magnetDistance,r=CKEDITOR.skin.margins||[0,0,0,0];void 0===a&&(a=20),t.parts.title.on("mousedown",function(s){if(n={x:s.data.$.screenX,y:s.data.$.screenY},CKEDITOR.document.on("mousemove",e),CKEDITOR.document.on("mouseup",i),o=t.getPosition(),CKEDITOR.env.ie6Compat){var a=b.getChild(0).getFrameDocument();a.on("mousemove",e),a.on("mouseup",i)}s.data.preventDefault()},t)}function c(t){function e(e){var i="rtl"==c.lang.dir,u=(e.data.$.screenX-l.x)*(i?-1:1),h=e.data.$.screenY-l.y,g=d.width,f=d.height,p=g+u*(t._.moved?1:2),_=f+h*(t._.moved?1:2),m=t._.element.getFirst(),I=i&&m.getComputedStyle("right"),v=t.getPosition();v.y+_>r.height&&(_=r.height-v.y),(i?I:v.x)+p>r.width&&(p=r.width-(i?I:v.x)),o!=CKEDITOR.DIALOG_RESIZE_WIDTH&&o!=CKEDITOR.DIALOG_RESIZE_BOTH||(g=Math.max(n.minWidth||0,p-s)),o!=CKEDITOR.DIALOG_RESIZE_HEIGHT&&o!=CKEDITOR.DIALOG_RESIZE_BOTH||(f=Math.max(n.minHeight||0,_-a)),t.resize(g,f),t._.moved||t.layout(),e.data.preventDefault()}function i(){if(CKEDITOR.document.removeListener("mouseup",i),CKEDITOR.document.removeListener("mousemove",e),u&&(u.remove(),u=null),CKEDITOR.env.ie6Compat){var t=b.getChild(0).getFrameDocument();t.removeListener("mouseup",i),t.removeListener("mousemove",e)}}var n=t.definition,o=n.resizable;if(o!=CKEDITOR.DIALOG_RESIZE_NONE){var s,a,r,l,d,u,c=t.getParentEditor(),h=CKEDITOR.tools.addFunction(function(n){d=t.getSize();var o=t.parts.contents;if(o.$.getElementsByTagName("iframe").length&&(u=CKEDITOR.dom.element.createFromHtml('<div class="cke_dialog_resize_cover" style="height: 100%; position: absolute; width: 100%;"></div>'),o.append(u)),a=d.height-t.parts.contents.getSize("height",!(CKEDITOR.env.gecko||CKEDITOR.env.ie&&CKEDITOR.env.quirks)),s=d.width-t.parts.contents.getSize("width",1),l={x:n.screenX,y:n.screenY},r=CKEDITOR.document.getWindow().getViewPaneSize(),CKEDITOR.document.on("mousemove",e),CKEDITOR.document.on("mouseup",i),CKEDITOR.env.ie6Compat){var c=b.getChild(0).getFrameDocument();c.on("mousemove",e),c.on("mouseup",i)}n.preventDefault&&n.preventDefault()});t.on("load",function(){var e="";o==CKEDITOR.DIALOG_RESIZE_WIDTH?e=" cke_resizer_horizontal":o==CKEDITOR.DIALOG_RESIZE_HEIGHT&&(e=" cke_resizer_vertical");var i=CKEDITOR.dom.element.createFromHtml('<div class="cke_resizer'+e+" cke_resizer_"+c.lang.dir+'" title="'+CKEDITOR.tools.htmlEncode(c.lang.common.resize)+'" onmousedown="CKEDITOR.tools.callFunction('+h+', event )">'+("ltr"==c.lang.dir?"◢":"◣")+"</div>");t.parts.footer.append(i,1)}),c.on("destroy",function(){CKEDITOR.tools.removeFunction(h)})}}function h(t){t.data.preventDefault(1)}function g(t){var e=CKEDITOR.document.getWindow(),i=t.config,n=CKEDITOR.skinName||t.config.skin,o=i.dialog_backgroundCoverColor||("moono-lisa"==n?"black":"white"),s=i.dialog_backgroundCoverOpacity,a=i.baseFloatZIndex,r=CKEDITOR.tools.genKey(o,s,a),l=O[r];if(l)l.show();else{var d=['<div tabIndex="-1" style="position: ',CKEDITOR.env.ie6Compat?"absolute":"fixed","; z-index: ",a,"; top: 0px; left: 0px; ",CKEDITOR.env.ie6Compat?"":"background-color: "+o,'" class="cke_dialog_background_cover">'];if(CKEDITOR.env.ie6Compat){var u="<html><body style=\\'background-color:"+o+";\\'></body></html>";d.push('<iframe hidefocus="true" frameborder="0" id="cke_dialog_background_iframe" src="javascript:'),d.push("void((function(){"+encodeURIComponent("document.open();("+CKEDITOR.tools.fixDomain+")();document.write( '"+u+"' );document.close();")+"})())"),d.push('" style="position:absolute;left:0;top:0;width:100%;height: 100%;filter: progid:DXImageTransform.Microsoft.Alpha(opacity=0)"></iframe>')}d.push("</div>"),(l=CKEDITOR.dom.element.createFromHtml(d.join(""))).setOpacity(void 0!==s?s:.5),l.on("keydown",h),l.on("keypress",h),l.on("keyup",h),l.appendTo(CKEDITOR.document.getBody()),O[r]=l}t.focusManager.add(l),b=l;var c=function(){var t=e.getViewPaneSize();l.setStyles({width:t.width+"px",height:t.height+"px"})},g=function(){var t=e.getScrollPosition(),i=CKEDITOR.dialog._.currentTop;if(l.setStyles({left:t.x+"px",top:t.y+"px"}),i)do{var n=i.getPosition();i.move(n.x,n.y)}while(i=i._.parentDialog)};if(T=c,e.on("resize",c),c(),CKEDITOR.env.mac&&CKEDITOR.env.webkit||l.focus(),CKEDITOR.env.ie6Compat){var f=function(){g(),arguments.callee.prevScrollHandler.apply(this,arguments)};e.$.setTimeout(function(){f.prevScrollHandler=window.onscroll||function(){},window.onscroll=f},0),g()}}function f(t){if(b){t.focusManager.remove(b);var e=CKEDITOR.document.getWindow();b.hide(),e.removeListener("resize",T),CKEDITOR.env.ie6Compat&&e.$.setTimeout(function(){var t=window.onscroll&&window.onscroll.prevScrollHandler;window.onscroll=t||null},0),T=null}}function p(){for(var t in O)O[t].remove();O={}}var _=CKEDITOR.tools.cssLength,m='<div class="cke_reset_all {editorId} {editorDialogClass} {hidpi}" dir="{langDir}" lang="{langCode}" role="dialog" aria-labelledby="cke_dialog_title_{id}"><table class="cke_dialog '+CKEDITOR.env.cssClass+' cke_{langDir}" style="position:absolute" role="presentation"><tr><td role="presentation"><div class="cke_dialog_body" role="presentation"><div id="cke_dialog_title_{id}" class="cke_dialog_title" role="presentation"></div><a id="cke_dialog_close_button_{id}" class="cke_dialog_close_button" href="javascript:void(0)" title="{closeTitle}" role="button"><span class="cke_label">X</span></a><div id="cke_dialog_tabs_{id}" class="cke_dialog_tabs" role="tablist"></div><table class="cke_dialog_contents" role="presentation"><tr><td id="cke_dialog_contents_{id}" class="cke_dialog_contents_body" role="presentation"></td></tr><tr><td id="cke_dialog_footer_{id}" class="cke_dialog_footer" role="presentation"></td></tr></table></div></td></tr></table></div>';CKEDITOR.dialog=function(t,n){function r(){var t=y._.focusList;t.sort(function(t,e){return t.tabIndex!=e.tabIndex?e.tabIndex-t.tabIndex:t.focusIndex-e.focusIndex});for(var e=t.length,i=0;i<e;i++)t[i].focusIndex=i}function l(t){var e=y._.focusList;if(t=t||0,!(e.length<1)){var i=y._.currentFocusIndex;y._.tabBarMode&&t<0&&(i=0);try{e[i].getInputElement().$.blur()}catch(t){}var n=i,o=y._.pageCount>1;do{if(n+=t,o&&!y._.tabBarMode&&(n==e.length||-1==n))return y._.tabBarMode=!0,y._.tabs[y._.currentTabId][0].focus(),void(y._.currentFocusIndex=-1);if((n=(n+e.length)%e.length)==i)break}while(t&&!e[n].isFocusable());e[n].focus(),"text"==e[n].type&&e[n].select()}}function d(n){if(y==CKEDITOR.dialog._.currentTop){var o,s=n.data.getKeystroke(),a="rtl"==t.lang.dir,r=[37,38,39,40];if(f=p=0,9==s||s==CKEDITOR.SHIFT+9)l(s==CKEDITOR.SHIFT+9?-1:1),f=1;else if(s==CKEDITOR.ALT+121&&!y._.tabBarMode&&y.getPageCount()>1)y._.tabBarMode=!0,y._.tabs[y._.currentTabId][0].focus(),y._.currentFocusIndex=-1,f=1;else if(-1!=CKEDITOR.tools.indexOf(r,s)&&y._.tabBarMode){var d=[a?39:37,38],u=-1!=CKEDITOR.tools.indexOf(d,s)?e.call(y):i.call(y);y.selectPage(u),y._.tabs[u][0].focus(),f=1}else if(13!=s&&32!=s||!y._.tabBarMode)if(13==s){var c=n.data.getTarget();c.is("a","button","select","textarea")||c.is("input")&&"button"==c.$.type||((o=this.getButton("ok"))&&CKEDITOR.tools.setTimeout(o.click,0,o),f=1),p=1}else{if(27!=s)return;(o=this.getButton("cancel"))?CKEDITOR.tools.setTimeout(o.click,0,o):!1!==this.fire("cancel",{hide:!0}).hide&&this.hide(),p=1}else this.selectPage(this._.currentTabId),this._.tabBarMode=!1,this._.currentFocusIndex=-1,l(1),f=1;h(n)}}function h(t){f?t.data.preventDefault(1):p&&t.data.stopPropagation()}var g,f,p,_=CKEDITOR.dialog._.dialogDefinitions[n],m=CKEDITOR.tools.clone(I),v=t.config.dialog_buttonsOrder||"OS",C=t.lang.dir,E={};("OS"==v&&CKEDITOR.env.mac||"rtl"==v&&"ltr"==C||"ltr"==v&&"rtl"==C)&&m.buttons.reverse(),_=CKEDITOR.tools.extend(_(t),m),_=CKEDITOR.tools.clone(_),_=new D(this,_);var T=a(t);this._={editor:t,element:T.element,name:n,contentSize:{width:0,height:0},size:{width:0,height:0},contents:{},buttons:{},accessKeyMap:{},tabs:{},tabIdList:[],currentTabId:null,currentTabIndex:null,pageCount:0,lastTab:null,tabBarMode:!1,focusList:[],currentFocusIndex:0,hasFocus:!1},this.parts=T.parts,CKEDITOR.tools.setTimeout(function(){t.fire("ariaWidget",this.parts.contents)},0,this);var b={position:CKEDITOR.env.ie6Compat?"absolute":"fixed",top:0,visibility:"hidden"};if(b["rtl"==C?"right":"left"]=0,this.parts.dialog.setStyles(b),CKEDITOR.event.call(this),this.definition=_=CKEDITOR.fire("dialogDefinition",{name:n,definition:_},t).definition,!("removeDialogTabs"in t._)&&t.config.removeDialogTabs){var O=t.config.removeDialogTabs.split(";");for(g=0;g<O.length;g++){var K=O[g].split(":");if(2==K.length){var R=K[0];E[R]||(E[R]=[]),E[R].push(K[1])}}t._.removeDialogTabs=E}if(t._.removeDialogTabs&&(E=t._.removeDialogTabs[n]))for(g=0;g<E.length;g++)_.removeContents(E[g]);_.onLoad&&this.on("load",_.onLoad),_.onShow&&this.on("show",_.onShow),_.onHide&&this.on("hide",_.onHide),_.onOk&&this.on("ok",function(e){t.fire("saveSnapshot"),setTimeout(function(){t.fire("saveSnapshot")},0),!1===_.onOk.call(this,e)&&(e.data.hide=!1)}),this.state=CKEDITOR.DIALOG_STATE_IDLE,_.onCancel&&this.on("cancel",function(t){!1===_.onCancel.call(this,t)&&(t.data.hide=!1)});var y=this,x=function(t){var e=y._.contents;for(var i in e)for(var n in e[i])if(t.call(this,e[i][n]))return};this.on("ok",function(t){x(function(e){if(e.validate){var i=e.validate(this),n="string"==typeof i||!1===i;return n&&(t.data.hide=!1,t.stop()),o.call(e,!n,"string"==typeof i?i:void 0),n}})},this,null,0),this.on("cancel",function(e){x(function(i){if(i.isChanged())return t.config.dialog_noConfirmCancel||confirm(t.lang.common.confirmCancel)||(e.data.hide=!1),!0})},this,null,0),this.parts.close.on("click",function(t){!1!==this.fire("cancel",{hide:!0}).hide&&this.hide(),t.data.preventDefault()},this),this.changeFocus=l;var k=this._.element;for(t.focusManager.add(k,1),this.on("show",function(){k.on("keydown",d,this),CKEDITOR.env.gecko&&k.on("keypress",h,this)}),this.on("hide",function(){k.removeListener("keydown",d),CKEDITOR.env.gecko&&k.removeListener("keypress",h),x(function(t){s.apply(t)})}),this.on("iframeAdded",function(t){new CKEDITOR.dom.document(t.data.iframe.$.contentWindow.document).on("keydown",d,this,null,0)}),this.on("show",function(){r();var e=y._.pageCount>1;if(t.config.dialog_startupFocusTab&&e)y._.tabBarMode=!0,y._.tabs[y._.currentTabId][0].focus(),y._.currentFocusIndex=-1;else if(!this._.hasFocus)if(this._.currentFocusIndex=e?-1:this._.focusList.length-1,_.onFocus){var i=_.onFocus.call(this);i&&i.focus()}else l(1)},this,null,4294967295),CKEDITOR.env.ie6Compat&&this.on("load",function(){var t=this.getElement(),e=t.getFirst();e.remove(),e.appendTo(t)},this),u(this),c(this),new CKEDITOR.dom.text(_.title,CKEDITOR.document).appendTo(this.parts.title),g=0;g<_.contents.length;g++){var w=_.contents[g];w&&this.addPage(w)}this.parts.tabs.on("click",function(t){var e=t.data.getTarget();if(e.hasClass("cke_dialog_tab")){var i=e.$.id;this.selectPage(i.substring(4,i.lastIndexOf("_"))),this._.tabBarMode&&(this._.tabBarMode=!1,this._.currentFocusIndex=-1,l(1)),t.data.preventDefault()}},this);var S=[],L=CKEDITOR.dialog._.uiElementBuilders.hbox.build(this,{type:"hbox",className:"cke_dialog_footer_buttons",widths:[],children:_.buttons},S).getChild();for(this.parts.footer.setHtml(S.join("")),g=0;g<L.length;g++)this._.buttons[L[g].id]=L[g]},CKEDITOR.dialog.prototype={destroy:function(){this.hide(),this._.element.remove()},resize:function(t,e){this._.contentSize&&this._.contentSize.width==t&&this._.contentSize.height==e||(CKEDITOR.dialog.fire("resize",{dialog:this,width:t,height:e},this._.editor),this.fire("resize",{width:t,height:e},this._.editor),this.parts.contents.setStyles({width:t+"px",height:e+"px"}),"rtl"==this._.editor.lang.dir&&this._.position&&(this._.position.x=CKEDITOR.document.getWindow().getViewPaneSize().width-this._.contentSize.width-parseInt(this._.element.getFirst().getStyle("right"),10)),this._.contentSize={width:t,height:e})},getSize:function(){var t=this._.element.getFirst();return{width:t.$.offsetWidth||0,height:t.$.offsetHeight||0}},move:function(t,e,i){var n=this._.element.getFirst(),o="rtl"==this._.editor.lang.dir,s="fixed"==n.getComputedStyle("position");if(CKEDITOR.env.ie&&n.setStyle("zoom","100%"),!s||!this._.position||this._.position.x!=t||this._.position.y!=e){if(this._.position={x:t,y:e},!s){var a=CKEDITOR.document.getWindow().getScrollPosition();t+=a.x,e+=a.y}if(o){var r=this.getSize();t=CKEDITOR.document.getWindow().getViewPaneSize().width-r.width-t}var l={top:(e>0?e:0)+"px"};l[o?"right":"left"]=(t>0?t:0)+"px",n.setStyles(l),i&&(this._.moved=1)}},getPosition:function(){return CKEDITOR.tools.extend({},this._.position)},show:function(){var t=this._.element,e=this.definition;t.getParent()&&t.getParent().equals(CKEDITOR.document.getBody())?t.setStyle("display","block"):t.appendTo(CKEDITOR.document.getBody()),this.resize(this._.contentSize&&this._.contentSize.width||e.width||e.minWidth,this._.contentSize&&this._.contentSize.height||e.height||e.minHeight),this.reset(),this.selectPage(this.definition.contents[0].id),null===CKEDITOR.dialog._.currentZIndex&&(CKEDITOR.dialog._.currentZIndex=this._.editor.config.baseFloatZIndex),this._.element.getFirst().setStyle("z-index",CKEDITOR.dialog._.currentZIndex+=10),null===CKEDITOR.dialog._.currentTop?(CKEDITOR.dialog._.currentTop=this,this._.parentDialog=null,g(this._.editor)):(this._.parentDialog=CKEDITOR.dialog._.currentTop,this._.parentDialog.getElement().getFirst().$.style.zIndex-=Math.floor(this._.editor.config.baseFloatZIndex/2),CKEDITOR.dialog._.currentTop=this),t.on("keydown",R),t.on("keyup",y),this._.hasFocus=!1;for(var i in e.contents)if(e.contents[i]){var n=e.contents[i],o=this._.tabs[n.id],s=n.requiredContent,a=0;if(o){for(var r in this._.contents[n.id]){var d=this._.contents[n.id][r];"hbox"!=d.type&&"vbox"!=d.type&&d.getInputElement()&&(d.requiredContent&&!this._.editor.activeFilter.check(d.requiredContent)?d.disable():(d.enable(),a++))}!a||s&&!this._.editor.activeFilter.check(s)?o[0].addClass("cke_dialog_tab_disabled"):o[0].removeClass("cke_dialog_tab_disabled")}}CKEDITOR.tools.setTimeout(function(){this.layout(),l(this),this.parts.dialog.setStyle("visibility",""),this.fireOnce("load",{}),CKEDITOR.ui.fire("ready",this),this.fire("show",{}),this._.editor.fire("dialogShow",this),this._.parentDialog||this._.editor.focusManager.lock(),this.foreach(function(t){t.setInitValue&&t.setInitValue()})},100,this)},layout:function(){var t=this.parts.dialog,e=this.getSize(),i=CKEDITOR.document.getWindow().getViewPaneSize(),n=(i.width-e.width)/2,o=(i.height-e.height)/2;CKEDITOR.env.ie6Compat||(e.height+(o>0?o:0)>i.height||e.width+(n>0?n:0)>i.width?t.setStyle("position","absolute"):t.setStyle("position","fixed")),this.move(this._.moved?this._.position.x:n,this._.moved?this._.position.y:o)},foreach:function(t){for(var e in this._.contents)for(var i in this._.contents[e])t.call(this,this._.contents[e][i]);return this},reset:function(){var t=function(t){t.reset&&t.reset(1)};return function(){return this.foreach(t),this}}(),setupContent:function(){var t=arguments;this.foreach(function(e){e.setup&&e.setup.apply(e,t)})},commitContent:function(){var t=arguments;this.foreach(function(e){CKEDITOR.env.ie&&this._.currentFocusIndex==e.focusIndex&&e.getInputElement().$.blur(),e.commit&&e.commit.apply(e,t)})},hide:function(){if(this.parts.dialog.isVisible()){this.fire("hide",{}),this._.editor.fire("dialogHide",this),this.selectPage(this._.tabIdList[0]);var t=this._.element;for(t.setStyle("display","none"),this.parts.dialog.setStyle("visibility","hidden"),k(this);CKEDITOR.dialog._.currentTop!=this;)CKEDITOR.dialog._.currentTop.hide();if(this._.parentDialog){var e=this._.parentDialog.getElement().getFirst();e.setStyle("z-index",parseInt(e.$.style.zIndex,10)+Math.floor(this._.editor.config.baseFloatZIndex/2))}else f(this._.editor);if(CKEDITOR.dialog._.currentTop=this._.parentDialog,this._.parentDialog)CKEDITOR.dialog._.currentZIndex-=10;else{CKEDITOR.dialog._.currentZIndex=null,t.removeListener("keydown",R),t.removeListener("keyup",y);var i=this._.editor;i.focus(),setTimeout(function(){i.focusManager.unlock(),CKEDITOR.env.iOS&&i.window.focus()},0)}delete this._.parentDialog,this.foreach(function(t){t.resetInitValue&&t.resetInitValue()}),this.setState(CKEDITOR.DIALOG_STATE_IDLE)}},addPage:function(t){if(!t.requiredContent||this._.editor.filter.check(t.requiredContent)){for(var e,i=[],n=t.label?' title="'+CKEDITOR.tools.htmlEncode(t.label)+'"':"",o=CKEDITOR.dialog._.uiElementBuilders.vbox.build(this,{type:"vbox",className:"cke_dialog_page_contents",children:t.elements,expand:!!t.expand,padding:t.padding,style:t.style||"width: 100%;"},i),s=this._.contents[t.id]={},a=o.getChild(),r=0;e=a.shift();)e.notAllowed||"hbox"==e.type||"vbox"==e.type||r++,s[e.id]=e,"function"==typeof e.getChild&&a.push.apply(a,e.getChild());r||(t.hidden=!0);var l=CKEDITOR.dom.element.createFromHtml(i.join(""));l.setAttribute("role","tabpanel");var d=CKEDITOR.env,u="cke_"+t.id+"_"+CKEDITOR.tools.getNextNumber(),c=CKEDITOR.dom.element.createFromHtml(['<a class="cke_dialog_tab"',this._.pageCount>0?" cke_last":"cke_first",n,t.hidden?' style="display:none"':"",' id="',u,'"',d.gecko&&!d.hc?"":' href="javascript:void(0)"',' tabIndex="-1"',' hidefocus="true"',' role="tab">',t.label,"</a>"].join(""));l.setAttribute("aria-labelledby",u),this._.tabs[t.id]=[c,l],this._.tabIdList.push(t.id),!t.hidden&&this._.pageCount++,this._.lastTab=c,this.updateStyle(),l.setAttribute("name",t.id),l.appendTo(this.parts.contents),c.unselectable(),this.parts.tabs.append(c),t.accessKey&&(x(this,this,"CTRL+"+t.accessKey,S,w),this._.accessKeyMap["CTRL+"+t.accessKey]=t.id)}},selectPage:function(t){if(this._.currentTabId!=t&&!this._.tabs[t][0].hasClass("cke_dialog_tab_disabled")&&!1!==this.fire("selectPage",{page:t,currentPage:this._.currentTabId})){for(var e in this._.tabs){var i=this._.tabs[e][0],o=this._.tabs[e][1];e!=t&&(i.removeClass("cke_dialog_tab_selected"),o.hide()),o.setAttribute("aria-hidden",e!=t)}var s=this._.tabs[t];s[0].addClass("cke_dialog_tab_selected"),CKEDITOR.env.ie6Compat||CKEDITOR.env.ie7Compat?(n(s[1]),s[1].show(),setTimeout(function(){n(s[1],1)},0)):s[1].show(),this._.currentTabId=t,this._.currentTabIndex=CKEDITOR.tools.indexOf(this._.tabIdList,t)}},updateStyle:function(){this.parts.dialog[(1===this._.pageCount?"add":"remove")+"Class"]("cke_single_page")},hidePage:function(t){var i=this._.tabs[t]&&this._.tabs[t][0];i&&1!=this._.pageCount&&i.isVisible()&&(t==this._.currentTabId&&this.selectPage(e.call(this)),i.hide(),this._.pageCount--,this.updateStyle())},showPage:function(t){var e=this._.tabs[t]&&this._.tabs[t][0];e&&(e.show(),this._.pageCount++,this.updateStyle())},getElement:function(){return this._.element},getName:function(){return this._.name},getContentElement:function(t,e){var i=this._.contents[t];return i&&i[e]},getValueOf:function(t,e){return this.getContentElement(t,e).getValue()},setValueOf:function(t,e,i){return this.getContentElement(t,e).setValue(i)},getButton:function(t){return this._.buttons[t]},click:function(t){return this._.buttons[t].click()},disableButton:function(t){return this._.buttons[t].disable()},enableButton:function(t){return this._.buttons[t].enable()},getPageCount:function(){return this._.pageCount},getParentEditor:function(){return this._.editor},getSelectedElement:function(){return this.getParentEditor().getSelection().getSelectedElement()},addFocusable:function(t,e){if(void 0===e)e=this._.focusList.length,this._.focusList.push(new r(this,t,e));else{this._.focusList.splice(e,0,new r(this,t,e));for(var i=e+1;i<this._.focusList.length;i++)this._.focusList[i].focusIndex++}},setState:function(t){if(this.state!=t){if(this.state=t,t==CKEDITOR.DIALOG_STATE_BUSY){if(!this.parts.spinner){var e=this.getParentEditor().lang.dir,i={attributes:{class:"cke_dialog_spinner"},styles:{float:"rtl"==e?"right":"left"}};i.styles["margin-"+("rtl"==e?"left":"right")]="8px",this.parts.spinner=CKEDITOR.document.createElement("div",i),this.parts.spinner.setHtml("&#8987;"),this.parts.spinner.appendTo(this.parts.title,1)}this.parts.spinner.show(),this.getButton("ok").disable()}else t==CKEDITOR.DIALOG_STATE_IDLE&&(this.parts.spinner&&this.parts.spinner.hide(),this.getButton("ok").enable());this.fire("state",t)}}},CKEDITOR.tools.extend(CKEDITOR.dialog,{add:function(t,e){this._.dialogDefinitions[t]&&"function"!=typeof e||(this._.dialogDefinitions[t]=e)},exists:function(t){return!!this._.dialogDefinitions[t]},getCurrent:function(){return CKEDITOR.dialog._.currentTop},isTabEnabled:function(t,e,i){var n=t.config.removeDialogTabs;return!(n&&n.match(new RegExp("(?:^|;)"+e+":"+i+"(?:$|;)","i")))},okButton:function(){var t=function(t,e){return e=e||{},CKEDITOR.tools.extend({id:"ok",type:"button",label:t.lang.common.ok,class:"cke_dialog_ui_button_ok",onClick:function(t){var e=t.data.dialog;!1!==e.fire("ok",{hide:!0}).hide&&e.hide()}},e,!0)};return t.type="button",t.override=function(e){return CKEDITOR.tools.extend(function(i){return t(i,e)},{type:"button"},!0)},t}(),cancelButton:function(){var t=function(t,e){return e=e||{},CKEDITOR.tools.extend({id:"cancel",type:"button",label:t.lang.common.cancel,class:"cke_dialog_ui_button_cancel",onClick:function(t){var e=t.data.dialog;!1!==e.fire("cancel",{hide:!0}).hide&&e.hide()}},e,!0)};return t.type="button",t.override=function(e){return CKEDITOR.tools.extend(function(i){return t(i,e)},{type:"button"},!0)},t}(),addUIElement:function(t,e){this._.uiElementBuilders[t]=e}}),CKEDITOR.dialog._={uiElementBuilders:{},dialogDefinitions:{},currentTop:null,currentZIndex:null},CKEDITOR.event.implementOn(CKEDITOR.dialog),CKEDITOR.event.implementOn(CKEDITOR.dialog.prototype);var I={resizable:CKEDITOR.DIALOG_RESIZE_BOTH,minWidth:600,minHeight:400,buttons:[CKEDITOR.dialog.okButton,CKEDITOR.dialog.cancelButton]},v=function(t,e,i){for(var n,o=0;n=t[o];o++){if(n.id==e)return n;if(i&&n[i]){var s=v(n[i],e,i);if(s)return s}}return null},C=function(t,e,i,n,o){if(i){for(var s,a=0;s=t[a];a++){if(s.id==i)return t.splice(a,0,e),e;if(n&&s[n]){var r=C(s[n],e,i,n,!0);if(r)return r}}if(o)return null}return t.push(e),e},E=function(t,e,i){for(var n,o=0;n=t[o];o++){if(n.id==e)return t.splice(o,1);if(i&&n[i]){var s=E(n[i],e,i);if(s)return s}}return null},D=function(t,e){this.dialog=t;for(var i,n=e.contents,o=0;i=n[o];o++)n[o]=i&&new d(t,i);CKEDITOR.tools.extend(this,e)};D.prototype={getContents:function(t){return v(this.contents,t)},getButton:function(t){return v(this.buttons,t)},addContents:function(t,e){return C(this.contents,t,e)},addButton:function(t,e){return C(this.buttons,t,e)},removeContents:function(t){E(this.contents,t)},removeButton:function(t){E(this.buttons,t)}},d.prototype={get:function(t){return v(this.elements,t,"children")},add:function(t,e){return C(this.elements,t,e,"children")},remove:function(t){E(this.elements,t,"children")}};var T,b,O={},K={},R=function(t){var e=t.data.$.ctrlKey||t.data.$.metaKey,i=t.data.$.altKey,n=t.data.$.shiftKey,o=String.fromCharCode(t.data.$.keyCode),s=K[(e?"CTRL+":"")+(i?"ALT+":"")+(n?"SHIFT+":"")+o];s&&s.length&&((s=s[s.length-1]).keydown&&s.keydown.call(s.uiElement,s.dialog,s.key),t.data.preventDefault())},y=function(t){var e=t.data.$.ctrlKey||t.data.$.metaKey,i=t.data.$.altKey,n=t.data.$.shiftKey,o=String.fromCharCode(t.data.$.keyCode),s=K[(e?"CTRL+":"")+(i?"ALT+":"")+(n?"SHIFT+":"")+o];s&&s.length&&(s=s[s.length-1]).keyup&&(s.keyup.call(s.uiElement,s.dialog,s.key),t.data.preventDefault())},x=function(t,e,i,n,o){(K[i]||(K[i]=[])).push({uiElement:t,dialog:e,key:i,keyup:o||t.accessKeyUp,keydown:n||t.accessKeyDown})},k=function(t){for(var e in K){for(var i=K[e],n=i.length-1;n>=0;n--)i[n].dialog!=t&&i[n].uiElement!=t||i.splice(n,1);0===i.length&&delete K[e]}},w=function(t,e){t._.accessKeyMap[e]&&t.selectPage(t._.accessKeyMap[e])},S=function(){};CKEDITOR.ui.dialog={uiElement:function(t,e,i,n,o,s,a){if(!(arguments.length<4)){var r,l=(n.call?n(e):n)||"div",d=["<",l," "],u=(o&&o.call?o(e):o)||{},c=(s&&s.call?s(e):s)||{},h=(a&&a.call?a.call(this,t,e):a)||"",g=this.domId=c.id||CKEDITOR.tools.getNextId()+"_uiElement";e.requiredContent&&!t.getParentEditor().filter.check(e.requiredContent)&&(u.display="none",this.notAllowed=!0),c.id=g;var f={};e.type&&(f["cke_dialog_ui_"+e.type]=1),e.className&&(f[e.className]=1),e.disabled&&(f.cke_disabled=1);var p=c.class&&c.class.split?c.class.split(" "):[];for(r=0;r<p.length;r++)p[r]&&(f[p[r]]=1);var _=[];for(r in f)_.push(r);c.class=_.join(" "),e.title&&(c.title=e.title);var m=(e.style||"").split(";");if(e.align){var I=e.align;u["margin-left"]="left"==I?0:"auto",u["margin-right"]="right"==I?0:"auto"}for(r in u)m.push(r+":"+u[r]);for(e.hidden&&m.push("display:none"),r=m.length-1;r>=0;r--)""===m[r]&&m.splice(r,1);m.length>0&&(c.style=(c.style?c.style+"; ":"")+m.join("; "));for(r in c)d.push(r+'="'+CKEDITOR.tools.htmlEncode(c[r])+'" ');d.push(">",h,"</",l,">"),i.push(d.join("")),(this._||(this._={})).dialog=t,"boolean"==typeof e.isChanged&&(this.isChanged=function(){return e.isChanged}),"function"==typeof e.isChanged&&(this.isChanged=e.isChanged),"function"==typeof e.setValue&&(this.setValue=CKEDITOR.tools.override(this.setValue,function(t){return function(i){t.call(this,e.setValue.call(this,i))}})),"function"==typeof e.getValue&&(this.getValue=CKEDITOR.tools.override(this.getValue,function(t){return function(){return e.getValue.call(this,t.call(this))}})),CKEDITOR.event.implementOn(this),this.registerEvents(e),this.accessKeyUp&&this.accessKeyDown&&e.accessKey&&x(this,t,"CTRL+"+e.accessKey);var v=this;t.on("load",function(){var e=v.getInputElement();if(e){var i=v.type in{checkbox:1,ratio:1}&&CKEDITOR.env.ie&&CKEDITOR.env.version<8?"cke_dialog_ui_focused":"";e.on("focus",function(){t._.tabBarMode=!1,t._.hasFocus=!0,v.fire("focus"),i&&this.addClass(i)}),e.on("blur",function(){v.fire("blur"),i&&this.removeClass(i)})}}),CKEDITOR.tools.extend(this,e),this.keyboardFocusable&&(this.tabIndex=e.tabIndex||0,this.focusIndex=t._.focusList.push(this)-1,this.on("focus",function(){t._.currentFocusIndex=v.focusIndex}))}},hbox:function(t,e,i,n,o){if(!(arguments.length<4)){this._||(this._={});var s,a=this._.children=e,r=o&&o.widths||null,l=o&&o.height||null,d={},u={role:"presentation"};o&&o.align&&(u.align=o.align),CKEDITOR.ui.dialog.uiElement.call(this,t,o||{type:"hbox"},n,"table",d,u,function(){var t=['<tbody><tr class="cke_dialog_ui_hbox">'];for(s=0;s<i.length;s++){var e="cke_dialog_ui_hbox_child",n=[];0===s&&(e="cke_dialog_ui_hbox_first"),s==i.length-1&&(e="cke_dialog_ui_hbox_last"),t.push('<td class="',e,'" role="presentation" '),r?r[s]&&n.push("width:"+_(r[s])):n.push("width:"+Math.floor(100/i.length)+"%"),l&&n.push("height:"+_(l)),o&&void 0!==o.padding&&n.push("padding:"+_(o.padding)),CKEDITOR.env.ie&&CKEDITOR.env.quirks&&a[s].align&&n.push("text-align:"+a[s].align),n.length>0&&t.push('style="'+n.join("; ")+'" '),t.push(">",i[s],"</td>")}return t.push("</tr></tbody>"),t.join("")})}},vbox:function(t,e,i,n,o){if(!(arguments.length<3)){this._||(this._={});var s=this._.children=e,a=o&&o.width||null,r=o&&o.heights||null;CKEDITOR.ui.dialog.uiElement.call(this,t,o||{type:"vbox"},n,"div",null,{role:"presentation"},function(){var e=['<table role="presentation" cellspacing="0" border="0" '];e.push('style="'),o&&o.expand&&e.push("height:100%;"),e.push("width:"+_(a||"100%"),";"),CKEDITOR.env.webkit&&e.push("float:none;"),e.push('"'),e.push('align="',CKEDITOR.tools.htmlEncode(o&&o.align||("ltr"==t.getParentEditor().lang.dir?"left":"right")),'" '),e.push("><tbody>");for(var n=0;n<i.length;n++){var l=[];e.push('<tr><td role="presentation" '),a&&l.push("width:"+_(a||"100%")),r?l.push("height:"+_(r[n])):o&&o.expand&&l.push("height:"+Math.floor(100/i.length)+"%"),o&&void 0!==o.padding&&l.push("padding:"+_(o.padding)),CKEDITOR.env.ie&&CKEDITOR.env.quirks&&s[n].align&&l.push("text-align:"+s[n].align),l.length>0&&e.push('style="',l.join("; "),'" '),e.push(' class="cke_dialog_ui_vbox_child">',i[n],"</td></tr>")}return e.push("</tbody></table>"),e.join("")})}}},CKEDITOR.ui.dialog.uiElement.prototype={getElement:function(){return CKEDITOR.document.getById(this.domId)},getInputElement:function(){return this.getElement()},getDialog:function(){return this._.dialog},setValue:function(t,e){return this.getInputElement().setValue(t),!e&&this.fire("change",{value:t}),this},getValue:function(){return this.getInputElement().getValue()},isChanged:function(){return!1},selectParentTab:function(){for(var t,e=this.getInputElement();(e=e.getParent())&&-1==e.$.className.search("cke_dialog_page_contents"););return e?(t=e.getAttribute("name"),this._.dialog._.currentTabId!=t&&this._.dialog.selectPage(t),this):this},focus:function(){return this.selectParentTab().getInputElement().focus(),this},registerEvents:function(t){var e,i=/^on([A-Z]\w+)/;for(var n in t)(e=n.match(i))&&(this.eventProcessors[n]?this.eventProcessors[n].call(this,this._.dialog,t[n]):function(t,e,i,n){e.on("load",function(){t.getInputElement().on(i,n,t)})}(this,this._.dialog,e[1].toLowerCase(),t[n]));return this},eventProcessors:{onLoad:function(t,e){t.on("load",e,this)},onShow:function(t,e){t.on("show",e,this)},onHide:function(t,e){t.on("hide",e,this)}},accessKeyDown:function(){this.focus()},accessKeyUp:function(){},disable:function(){var t=this.getElement();this.getInputElement().setAttribute("disabled","true"),t.addClass("cke_disabled")},enable:function(){var t=this.getElement();this.getInputElement().removeAttribute("disabled"),t.removeClass("cke_disabled")},isEnabled:function(){return!this.getElement().hasClass("cke_disabled")},isVisible:function(){return this.getInputElement().isVisible()},isFocusable:function(){return!(!this.isEnabled()||!this.isVisible())}},CKEDITOR.ui.dialog.hbox.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.uiElement,{getChild:function(t){return arguments.length<1?this._.children.concat():(t.splice||(t=[t]),t.length<2?this._.children[t[0]]:this._.children[t[0]]&&this._.children[t[0]].getChild?this._.children[t[0]].getChild(t.slice(1,t.length)):null)}},!0),CKEDITOR.ui.dialog.vbox.prototype=new CKEDITOR.ui.dialog.hbox,function(){var t={build:function(t,e,i){for(var n,o=e.children,s=[],a=[],r=0;r<o.length&&(n=o[r]);r++){var l=[];s.push(l),a.push(CKEDITOR.dialog._.uiElementBuilders[n.type].build(t,n,l))}return new CKEDITOR.ui.dialog[e.type](t,a,s,i,e)}};CKEDITOR.dialog.addUIElement("hbox",t),CKEDITOR.dialog.addUIElement("vbox",t)}(),CKEDITOR.dialogCommand=function(t,e){this.dialogName=t,CKEDITOR.tools.extend(this,e,!0)},CKEDITOR.dialogCommand.prototype={exec:function(t){t.openDialog(this.dialogName)},canUndo:!1,editorFocus:1},function(){var t=/^([a]|[^a])+$/,e=/^\d*$/,i=/^\d*(?:\.\d+)?$/,n=/^(((\d*(\.\d+))|(\d*))(px|\%)?)?$/,o=/^(((\d*(\.\d+))|(\d*))(px|em|ex|in|cm|mm|pt|pc|\%)?)?$/i,s=/^(\s*[\w-]+\s*:\s*[^:;]+(?:;|$))*$/;CKEDITOR.VALIDATE_OR=1,CKEDITOR.VALIDATE_AND=2,CKEDITOR.dialog.validate={functions:function(){var t=arguments;return function(){var e,i,n=this&&this.getValue?this.getValue():t[0],o=CKEDITOR.VALIDATE_AND,s=[];for(i=0;i<t.length&&"function"==typeof t[i];i++)s.push(t[i]);i<t.length&&"string"==typeof t[i]&&(e=t[i],i++),i<t.length&&"number"==typeof t[i]&&(o=t[i]);var a=o==CKEDITOR.VALIDATE_AND;for(i=0;i<s.length;i++)a=o==CKEDITOR.VALIDATE_AND?a&&s[i](n):a||s[i](n);return!!a||e}},regex:function(t,e){return function(){var i=this&&this.getValue?this.getValue():arguments[0];return!!t.test(i)||e}},notEmpty:function(e){return this.regex(t,e)},integer:function(t){return this.regex(e,t)},number:function(t){return this.regex(i,t)},cssLength:function(t){return this.functions(function(t){return o.test(CKEDITOR.tools.trim(t))},t)},htmlLength:function(t){return this.functions(function(t){return n.test(CKEDITOR.tools.trim(t))},t)},inlineStyle:function(t){return this.functions(function(t){return s.test(CKEDITOR.tools.trim(t))},t)},equals:function(t,e){return this.functions(function(e){return e==t},e)},notEqual:function(t,e){return this.functions(function(e){return e!=t},e)}},CKEDITOR.on("instanceDestroyed",function(t){if(CKEDITOR.tools.isEmpty(CKEDITOR.instances)){for(var e;e=CKEDITOR.dialog._.currentTop;)e.hide();p()}var i=t.editor._.storedDialogs;for(var n in i)i[n].destroy()})}(),CKEDITOR.tools.extend(CKEDITOR.editor.prototype,{openDialog:function(t,e){var i=null,n=CKEDITOR.dialog._.dialogDefinitions[t];if(null===CKEDITOR.dialog._.currentTop&&g(this),"function"==typeof n){var o=this._.storedDialogs||(this._.storedDialogs={});i=o[t]||(o[t]=new CKEDITOR.dialog(this,t)),e&&e.call(i,i),i.show()}else{if("failed"==n)throw f(this),new Error('[CKEDITOR.dialog.openDialog] Dialog "'+t+'" failed when loading definition.');"string"==typeof n&&CKEDITOR.scriptLoader.load(CKEDITOR.getUrl(n),function(){"function"!=typeof CKEDITOR.dialog._.dialogDefinitions[t]&&(CKEDITOR.dialog._.dialogDefinitions[t]="failed"),this.openDialog(t,e)},this,0,1)}return CKEDITOR.skin.loadPart("dialog"),i}})}(),CKEDITOR.plugins.add("dialog",{requires:"dialogui",init:function(t){t.on("doubleclick",function(e){e.data.dialog&&t.openDialog(e.data.dialog)},null,null,999)}});