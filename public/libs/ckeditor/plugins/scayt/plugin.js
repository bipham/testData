"use strict";CKEDITOR.plugins.add("scayt",{requires:"menubutton,dialog",lang:"af,ar,bg,bn,bs,ca,cs,cy,da,de,el,en-au,en-ca,en-gb,en,eo,es,et,eu,fa,fi,fo,fr-ca,fr,gl,gu,he,hi,hr,hu,is,it,ja,ka,km,ko,lt,lv,mk,mn,ms,nb,nl,no,pl,pt-br,pt,ro,ru,sk,sl,sr-latn,sr,sv,th,tr,ug,uk,vi,zh-cn,zh",icons:"scayt",hidpi:!0,tabToOpen:null,dialogName:"scaytDialog",onLoad:function(t){CKEDITOR.plugins.scayt.onLoadTimestamp=(new Date).getTime(),"moono-lisa"==(CKEDITOR.skinName||t.config.skin)&&CKEDITOR.document.appendStyleSheet(this.path+"skins/"+CKEDITOR.skin.name+"/scayt.css"),CKEDITOR.document.appendStyleSheet(this.path+"dialogs/dialog.css")},init:function(t){var e=this,a=CKEDITOR.plugins.scayt;this.bindEvents(t),this.parseConfig(t),this.addRule(t),CKEDITOR.dialog.add(this.dialogName,CKEDITOR.getUrl(this.path+"dialogs/options.js")),this.addMenuItems(t),t.config;var o=t.lang.scayt,n=CKEDITOR.env;t.ui.add("Scayt",CKEDITOR.UI_MENUBUTTON,{label:o.text_title,title:t.plugins.wsc?t.lang.wsc.title:o.text_title,modes:{wysiwyg:!(n.ie&&(n.version<8||n.quirks))},toolbar:"spellchecker,20",refresh:function(){var e=t.ui.instances.Scayt.getState();t.scayt&&(e=a.state.scayt[t.name]?CKEDITOR.TRISTATE_ON:CKEDITOR.TRISTATE_OFF),t.fire("scaytButtonState",e)},onRender:function(){var e=this;t.on("scaytButtonState",function(t){void 0!==typeof t.data&&e.setState(t.data)})},onMenu:function(){var e=t.scayt;t.getMenuItem("scaytToggle").label=t.lang.scayt[e&&a.state.scayt[t.name]?"btn_disable":"btn_enable"];var o={scaytToggle:CKEDITOR.TRISTATE_OFF,scaytOptions:e?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED,scaytLangs:e?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED,scaytDict:e?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED,scaytAbout:e?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED,WSC:t.plugins.wsc?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED};return t.config.scayt_uiTabs[0]||delete o.scaytOptions,t.config.scayt_uiTabs[1]||delete o.scaytLangs,t.config.scayt_uiTabs[2]||delete o.scaytDict,e&&!CKEDITOR.plugins.scayt.isNewUdSupported(e)&&(delete o.scaytDict,t.config.scayt_uiTabs[2]=0,CKEDITOR.plugins.scayt.alarmCompatibilityMessage()),o}}),t.contextMenu&&t.addMenuItems&&(t.contextMenu.addListener(function(a,o){var n,s,i=t.scayt;if(i&&(s=i.getSelectionNode())){var c=e.menuGenerator(t,s);i.showBanner("."+t.contextMenu._.definition.panel.className.split(" ").join(" .")),n=c}return n}),t.contextMenu._.onHide=CKEDITOR.tools.override(t.contextMenu._.onHide,function(e){return function(){var a=t.scayt;return a&&a.hideBanner(),e.apply(this)}}))},addMenuItems:function(t){var e=this,a=CKEDITOR.plugins.scayt,o=["grayt_description","grayt_suggest","grayt_control"],n="scaytButton";t.addMenuGroup(n);for(var s=t.config.scayt_contextMenuItemsOrder.split("|"),i=0;i<s.length;i++)s[i]="scayt_"+s[i];if((s=o.concat(s))&&s.length)for(i=0;i<s.length;i++)t.addMenuGroup(s[i],i-10);t.addCommand("scaytToggle",{exec:function(t){var e=t.scayt;a.state.scayt[t.name]=!a.state.scayt[t.name],!0===a.state.scayt[t.name]?e||a.createScayt(t):e&&a.destroy(t)}}),t.addCommand("scaytAbout",{exec:function(t){t.scayt.tabToOpen="about",t.lockSelection(),t.openDialog(e.dialogName)}}),t.addCommand("scaytOptions",{exec:function(t){t.scayt.tabToOpen="options",t.lockSelection(),t.openDialog(e.dialogName)}}),t.addCommand("scaytLangs",{exec:function(t){t.scayt.tabToOpen="langs",t.lockSelection(),t.openDialog(e.dialogName)}}),t.addCommand("scaytDict",{exec:function(t){t.scayt.tabToOpen="dictionaries",t.lockSelection(),t.openDialog(e.dialogName)}});var c={scaytToggle:{label:t.lang.scayt.btn_enable,group:n,command:"scaytToggle"},scaytAbout:{label:t.lang.scayt.btn_about,group:n,command:"scaytAbout"},scaytOptions:{label:t.lang.scayt.btn_options,group:n,command:"scaytOptions"},scaytLangs:{label:t.lang.scayt.btn_langs,group:n,command:"scaytLangs"},scaytDict:{label:t.lang.scayt.btn_dictionaries,group:n,command:"scaytDict"}};t.plugins.wsc&&(c.WSC={label:t.lang.wsc.toolbar,group:n,onClick:function(){var e=t.elementMode==CKEDITOR.ELEMENT_MODE_INLINE,a=CKEDITOR.plugins.scayt,o=t.scayt,n=e?t.container.getText():t.document.getBody().getText();(n=n.replace(/\s/g,""))?(o&&a.state.scayt[t.name]&&o.setMarkupPaused&&o.setMarkupPaused(!0),t.lockSelection(),t.execCommand("checkspell")):alert("Nothing to check!")}}),t.addMenuItems(c)},bindEvents:function(t){var e=CKEDITOR.plugins.scayt,a=t.elementMode==CKEDITOR.ELEMENT_MODE_INLINE,o=function(){e.destroy(t)},n=function(){!e.state.scayt[t.name]||t.readOnly||t.scayt||e.createScayt(t)},s=function(){var e=t.editable();e.attachListener(e,"focus",function(e){CKEDITOR.plugins.scayt&&!t.scayt&&setTimeout(n,0);var o,s,i,c=CKEDITOR.plugins.scayt&&CKEDITOR.plugins.scayt.state.scayt[t.name]&&t.scayt;if((a||c)&&t._.savedSelection){o=!t._.savedSelection.getSelectedElement()&&t._.savedSelection.getRanges();for(var r=0;r<o.length;r++)"string"==typeof(i=o[r]).startContainer.$.nodeValue&&((s=i.startContainer.getText().length)<i.startOffset||s<i.endOffset)&&t.unlockSelection(!1)}},this,null,-10)},i=function(){a?t.config.scayt_inlineModeImmediateMarkup?n():(t.on("blur",function(){setTimeout(o,0)}),t.on("focus",n),t.focusManager.hasFocus&&n()):n(),s();var e=t.editable();e.attachListener(e,"mousedown",function(e){var a=e.data.getTarget(),o=t.widgets&&t.widgets.getByElement(a);o&&(o.wrapper=a.getAscendant(function(t){return t.hasAttribute("data-cke-widget-wrapper")},!0))},this,null,-10)};t.on("contentDom",i),t.on("beforeCommandExec",function(a){var o=t.scayt,n=!1,s=!1,i=!0;a.data.name in e.options.disablingCommandExec&&"wysiwyg"==t.mode?o&&(e.destroy(t),t.fire("scaytButtonState",CKEDITOR.TRISTATE_DISABLED)):"bold"!==a.data.name&&"italic"!==a.data.name&&"underline"!==a.data.name&&"strike"!==a.data.name&&"subscript"!==a.data.name&&"superscript"!==a.data.name&&"enter"!==a.data.name&&"cut"!==a.data.name&&"language"!==a.data.name||o&&("cut"===a.data.name&&(i=!1,s=!0),"language"===a.data.name&&(n=!0,s=!0),t.fire("reloadMarkupScayt",{removeOptions:{removeInside:i,forceBookmark:s,language:n},timeout:0}))}),t.on("beforeSetMode",function(a){"source"==a.data&&(t.scayt&&(e.destroy(t),t.fire("scaytButtonState",CKEDITOR.TRISTATE_DISABLED)),t.document&&t.document.getBody().removeAttribute("_jquid"))}),t.on("afterCommandExec",function(a){"wysiwyg"!=t.mode||"undo"!=a.data.name&&"redo"!=a.data.name||setTimeout(function(){var a=t.scayt;e.reloadMarkup(a)},250)}),t.on("readOnly",function(a){var o;a&&(o=t.scayt,!0===a.editor.readOnly?o&&o.fire("removeMarkupInDocument",{}):o?e.reloadMarkup(o):"wysiwyg"==a.editor.mode&&!0===e.state.scayt[a.editor.name]&&(e.createScayt(t),a.editor.fire("scaytButtonState",CKEDITOR.TRISTATE_ON)))}),t.on("beforeDestroy",o),t.on("setData",function(){o(),(t.elementMode==CKEDITOR.ELEMENT_MODE_INLINE||t.plugins.divarea)&&i()},this,null,50),t.on("reloadMarkupScayt",function(a){var o=a.data&&a.data.removeOptions,n=a.data&&a.data.timeout,s=a.data&&a.data.language,i=t.scayt;i&&setTimeout(function(){s&&(o.selectionNode=t.plugins.language.getCurrentLangElement(t),o.selectionNode=o.selectionNode&&o.selectionNode.$||null),i.removeMarkupInSelectionNode(o),e.reloadMarkup(i)},n||0)}),t.on("insertElement",function(){t.fire("reloadMarkupScayt",{removeOptions:{forceBookmark:!0}})},this,null,50),t.on("insertHtml",function(){t.scayt&&t.scayt.setFocused&&t.scayt.setFocused(!0),t.fire("reloadMarkupScayt")},this,null,50),t.on("insertText",function(){t.scayt&&t.scayt.setFocused&&t.scayt.setFocused(!0),t.fire("reloadMarkupScayt")},this,null,50),t.on("scaytDialogShown",function(e){var a=e.data,o=t.scayt;a.selectPage(o.tabToOpen)})},parseConfig:function(t){var e=CKEDITOR.plugins.scayt;if(e.replaceOldOptionsNames(t.config),"boolean"!=typeof t.config.scayt_autoStartup&&(t.config.scayt_autoStartup=!1),e.state.scayt[t.name]=t.config.scayt_autoStartup,"boolean"!=typeof t.config.grayt_autoStartup&&(t.config.grayt_autoStartup=!1),"boolean"!=typeof t.config.scayt_inlineModeImmediateMarkup&&(t.config.scayt_inlineModeImmediateMarkup=!1),e.state.grayt[t.name]=t.config.grayt_autoStartup,t.config.scayt_contextCommands||(t.config.scayt_contextCommands="ignore|ignoreall|add"),t.config.scayt_contextMenuItemsOrder||(t.config.scayt_contextMenuItemsOrder="suggest|moresuggest|control"),t.config.scayt_sLang||(t.config.scayt_sLang="en_US"),(void 0===t.config.scayt_maxSuggestions||"number"!=typeof t.config.scayt_maxSuggestions||t.config.scayt_maxSuggestions<0)&&(t.config.scayt_maxSuggestions=5),(void 0===t.config.scayt_minWordLength||"number"!=typeof t.config.scayt_minWordLength||t.config.scayt_minWordLength<1)&&(t.config.scayt_minWordLength=4),void 0!==t.config.scayt_customDictionaryIds&&"string"==typeof t.config.scayt_customDictionaryIds||(t.config.scayt_customDictionaryIds=""),void 0!==t.config.scayt_userDictionaryName&&"string"==typeof t.config.scayt_userDictionaryName||(t.config.scayt_userDictionaryName=null),"string"==typeof t.config.scayt_uiTabs&&3===t.config.scayt_uiTabs.split(",").length){var a=[],o=[];t.config.scayt_uiTabs=t.config.scayt_uiTabs.split(","),CKEDITOR.tools.search(t.config.scayt_uiTabs,function(t){1===Number(t)||0===Number(t)?(o.push(!0),a.push(Number(t))):o.push(!1)}),null===CKEDITOR.tools.search(o,!1)?t.config.scayt_uiTabs=a:t.config.scayt_uiTabs=[1,1,1]}else t.config.scayt_uiTabs=[1,1,1];if("string"!=typeof t.config.scayt_serviceProtocol&&(t.config.scayt_serviceProtocol=null),"string"!=typeof t.config.scayt_serviceHost&&(t.config.scayt_serviceHost=null),"string"!=typeof t.config.scayt_servicePort&&(t.config.scayt_servicePort=null),"string"!=typeof t.config.scayt_servicePath&&(t.config.scayt_servicePath=null),t.config.scayt_moreSuggestions||(t.config.scayt_moreSuggestions="on"),"string"!=typeof t.config.scayt_customerId&&(t.config.scayt_customerId="1:WvF0D4-UtPqN1-43nkD4-NKvUm2-daQqk3-LmNiI-z7Ysb4-mwry24-T8YrS3-Q2tpq2"),"string"!=typeof t.config.scayt_customPunctuation&&(t.config.scayt_customPunctuation="-"),"string"!=typeof t.config.scayt_srcUrl){var n=document.location.protocol;n=-1!=n.search(/https?:/)?n:"http:",t.config.scayt_srcUrl=n+"//svc.webspellchecker.net/spellcheck31/lf/scayt3/ckscayt/ckscayt.js"}if("boolean"!=typeof CKEDITOR.config.scayt_handleCheckDirty&&(CKEDITOR.config.scayt_handleCheckDirty=!0),"boolean"!=typeof CKEDITOR.config.scayt_handleUndoRedo&&(CKEDITOR.config.scayt_handleUndoRedo=!0),CKEDITOR.config.scayt_handleUndoRedo=!!CKEDITOR.plugins.undo&&CKEDITOR.config.scayt_handleUndoRedo,"boolean"!=typeof t.config.scayt_multiLanguageMode&&(t.config.scayt_multiLanguageMode=!1),"object"!=typeof t.config.scayt_multiLanguageStyles&&(t.config.scayt_multiLanguageStyles={}),t.config.scayt_ignoreAllCapsWords&&"boolean"!=typeof t.config.scayt_ignoreAllCapsWords&&(t.config.scayt_ignoreAllCapsWords=!1),t.config.scayt_ignoreDomainNames&&"boolean"!=typeof t.config.scayt_ignoreDomainNames&&(t.config.scayt_ignoreDomainNames=!1),t.config.scayt_ignoreWordsWithMixedCases&&"boolean"!=typeof t.config.scayt_ignoreWordsWithMixedCases&&(t.config.scayt_ignoreWordsWithMixedCases=!1),t.config.scayt_ignoreWordsWithNumbers&&"boolean"!=typeof t.config.scayt_ignoreWordsWithNumbers&&(t.config.scayt_ignoreWordsWithNumbers=!1),t.config.scayt_disableOptionsStorage){var s=CKEDITOR.tools.isArray(t.config.scayt_disableOptionsStorage)?t.config.scayt_disableOptionsStorage:"string"==typeof t.config.scayt_disableOptionsStorage?[t.config.scayt_disableOptionsStorage]:void 0,i=["all","options","lang","ignore-all-caps-words","ignore-domain-names","ignore-words-with-mixed-cases","ignore-words-with-numbers"],c=["lang","ignore-all-caps-words","ignore-domain-names","ignore-words-with-mixed-cases","ignore-words-with-numbers"],r=CKEDITOR.tools.search,g=CKEDITOR.tools.indexOf,l=function(t){return!!r(i,t)};t.config.scayt_disableOptionsStorage=function(t){for(var e=[],a=0;a<t.length;a++){var o=t[a],n=!!r(t,"options");if(!l(o)||n&&r(c,function(t){if("lang"===t)return!1}))return;if(r(c,o)&&c.splice(g(c,o),1),"all"===o||n&&r(t,"lang"))return[];"options"===o&&(c=["lang"])}return e=e.concat(c)}(s)}},addRule:function(t){var e=CKEDITOR.plugins.scayt,a=t.dataProcessor,o=a&&a.htmlFilter,n=t._.elementsPath&&t._.elementsPath.filters,s=a&&a.dataFilter,i=t.addRemoveFormatFilter;if(n&&n.push(function(a){if(t.scayt&&(a.hasAttribute(e.options.data_attribute_name)||a.hasAttribute(e.options.problem_grammar_data_attribute)))return!1}),s){var c={elements:{span:function(t){var a=t.hasClass(e.options.misspelled_word_class)&&t.attributes[e.options.data_attribute_name],o=t.hasClass(e.options.problem_grammar_class)&&t.attributes[e.options.problem_grammar_data_attribute];return e&&(a||o)&&delete t.name,t}}};s.addRules(c)}if(o){var r={elements:{span:function(t){var a=t.hasClass(e.options.misspelled_word_class)&&t.attributes[e.options.data_attribute_name],o=t.hasClass(e.options.problem_grammar_class)&&t.attributes[e.options.problem_grammar_data_attribute];return e&&(a||o)&&delete t.name,t}}};o.addRules(r)}i&&i.call(t,function(a){var o=!0;return t.scayt&&(a.hasAttribute(e.options.data_attribute_name)||a.hasAttribute(e.options.problem_grammar_data_attribute))&&(o=!1),o})},scaytMenuDefinition:function(t){var e=this,a=(CKEDITOR.plugins.scayt,t.scayt);return{scayt:{scayt_ignore:{label:a.getLocal("btn_ignore"),group:"scayt_control",order:1,exec:function(t){t.scayt.ignoreWord()}},scayt_ignoreall:{label:a.getLocal("btn_ignoreAll"),group:"scayt_control",order:2,exec:function(t){t.scayt.ignoreAllWords()}},scayt_add:{label:a.getLocal("btn_addWord"),group:"scayt_control",order:3,exec:function(t){var e=t.scayt;setTimeout(function(){e.addWordToUserDictionary()},10)}},scayt_option:{label:a.getLocal("btn_options"),group:"scayt_control",order:4,exec:function(t){t.scayt.tabToOpen="options",t.lockSelection(),t.openDialog(e.dialogName)},verification:function(t){return 1==t.config.scayt_uiTabs[0]}},scayt_language:{label:a.getLocal("btn_langs"),group:"scayt_control",order:5,exec:function(t){t.scayt.tabToOpen="langs",t.lockSelection(),t.openDialog(e.dialogName)},verification:function(t){return 1==t.config.scayt_uiTabs[1]}},scayt_dictionary:{label:a.getLocal("btn_dictionaries"),group:"scayt_control",order:6,exec:function(t){t.scayt.tabToOpen="dictionaries",t.lockSelection(),t.openDialog(e.dialogName)},verification:function(t){return 1==t.config.scayt_uiTabs[2]}},scayt_about:{label:a.getLocal("btn_about"),group:"scayt_control",order:7,exec:function(t){t.scayt.tabToOpen="about",t.lockSelection(),t.openDialog(e.dialogName)}}},grayt:{grayt_problemdescription:{label:"Grammar problem description",group:"grayt_description",order:1,state:CKEDITOR.TRISTATE_DISABLED,exec:function(t){}},grayt_ignore:{label:a.getLocal("btn_ignore"),group:"grayt_control",order:2,exec:function(t){t.scayt.ignorePhrase()}}}}},buildSuggestionMenuItems:function(t,e,a){var o=this,n={},s={},i=a?"word":"phrase",c=a?"startGrammarCheck":"startSpellCheck",r=(CKEDITOR.plugins.scayt,t.scayt);if(e.length>0&&"no_any_suggestions"!==e[0])if(a)for(g=0;g<e.length;g++)l="scayt_suggest_"+CKEDITOR.plugins.scayt.suggestions[g].replace(" ","_"),t.addCommand(l,o.createCommand(CKEDITOR.plugins.scayt.suggestions[g],i,c)),g<t.config.scayt_maxSuggestions?(t.addMenuItem(l,{label:e[g],command:l,group:"scayt_suggest",order:g+1}),n[l]=CKEDITOR.TRISTATE_OFF):(t.addMenuItem(l,{label:e[g],command:l,group:"scayt_moresuggest",order:g+1}),s[l]=CKEDITOR.TRISTATE_OFF,"on"===t.config.scayt_moreSuggestions&&(t.addMenuItem("scayt_moresuggest",{label:r.getLocal("btn_moreSuggestions"),group:"scayt_moresuggest",order:10,getItems:function(){return s}}),n.scayt_moresuggest=CKEDITOR.TRISTATE_OFF));else for(var g=0;g<e.length;g++){var l="grayt_suggest_"+CKEDITOR.plugins.scayt.suggestions[g].replace(" ","_");t.addCommand(l,o.createCommand(CKEDITOR.plugins.scayt.suggestions[g],i,c)),t.addMenuItem(l,{label:e[g],command:l,group:"grayt_suggest",order:g+1}),n[l]=CKEDITOR.TRISTATE_OFF}else n.no_scayt_suggest=CKEDITOR.TRISTATE_DISABLED,t.addCommand("no_scayt_suggest",{exec:function(){}}),t.addMenuItem("no_scayt_suggest",{label:r.getLocal("btn_noSuggestions")||"no_scayt_suggest",command:"no_scayt_suggest",group:"scayt_suggest",order:0});return n},menuGenerator:function(t,e){var a,o,n,s,i,c=t.scayt,r=this.scaytMenuDefinition(t),g={},l=t.config.scayt_contextCommands.split("|"),u=e.getAttribute(c.getLangAttribute())||c.getLang();if(n=c.isScaytNode(e),s=c.isGraytNode(e),n?(r=r.scayt,a=e.getAttribute(c.getScaytNodeAttributeName()),c.fire("getSuggestionsList",{lang:u,word:a}),g=this.buildSuggestionMenuItems(t,CKEDITOR.plugins.scayt.suggestions,n)):s&&(r=r.grayt,o=e.getAttribute(c.getGraytNodeAttributeName()),i=c.getProblemDescriptionText(o,u),r.grayt_problemdescription&&i&&(r.grayt_problemdescription.label=i),c.fire("getGrammarSuggestionsList",{lang:u,phrase:o}),g=this.buildSuggestionMenuItems(t,CKEDITOR.plugins.scayt.suggestions,n)),n&&"off"==t.config.scayt_contextCommands)return g;for(var d in r)n&&-1==CKEDITOR.tools.indexOf(l,d.replace("scayt_",""))&&"all"!=t.config.scayt_contextCommands||(void 0!==r[d].state?g[d]=r[d].state:g[d]=CKEDITOR.TRISTATE_OFF,"function"!=typeof r[d].verification||r[d].verification(t)||delete g[d],t.addCommand(d,{exec:r[d].exec}),t.addMenuItem(d,{label:t.lang.scayt[r[d].label]||r[d].label,command:d,group:r[d].group,order:r[d].order}));return g},createCommand:function(t,e,a){return{exec:function(o){var n=o.scayt,s={};s[e]=t,n.replaceSelectionNode(s),"startGrammarCheck"===a&&n.removeMarkupInSelectionNode({grammarOnly:!0}),n.fire(a)}}}}),CKEDITOR.plugins.scayt={charsToObserve:[{charName:"cke-fillingChar",charCode:function(){var t,e=CKEDITOR.version.match(/^\d(\.\d*)*/),a=e&&e[0];return a&&(t=function(t,e){var a;return t=t.replace(/\./g,""),e=e.replace(/\./g,""),a=t.length-e.length,a=a>=0?a:0,parseInt(t)>=parseInt(e)*Math.pow(10,a)}(a,"4.5.7")),t?new Array(7).join(String.fromCharCode(8203)):String.fromCharCode(8203)}()}],onLoadTimestamp:"",state:{scayt:{},grayt:{}},warningCounter:0,suggestions:[],options:{disablingCommandExec:{source:!0,newpage:!0,templates:!0},data_attribute_name:"data-scayt-word",misspelled_word_class:"scayt-misspell-word",problem_grammar_data_attribute:"data-grayt-phrase",problem_grammar_class:"gramm-problem"},backCompatibilityMap:{scayt_service_protocol:"scayt_serviceProtocol",scayt_service_host:"scayt_serviceHost",scayt_service_port:"scayt_servicePort",scayt_service_path:"scayt_servicePath",scayt_customerid:"scayt_customerId"},alarmCompatibilityMessage:function(){this.warningCounter<5&&(console.warn("You are using the latest version of SCAYT plugin for CKEditor with the old application version. In order to have access to the newest features, it is recommended to upgrade the application version to latest one as well. Contact us for more details at support@webspellchecker.net."),this.warningCounter+=1)},isNewUdSupported:function(t){return!!t.getUserDictionary},reloadMarkup:function(t){var e;t&&(e=t.getScaytLangList(),t.reloadMarkup?t.reloadMarkup():(this.alarmCompatibilityMessage(),e&&e.ltr&&e.rtl&&t.fire("startSpellCheck, startGrammarCheck")))},replaceOldOptionsNames:function(t){for(var e in t)e in this.backCompatibilityMap&&(t[this.backCompatibilityMap[e]]=t[e],delete t[e])},createScayt:function(t){var e=this,a=CKEDITOR.plugins.scayt;this.loadScaytLibrary(t,function(t){function o(t){return new SCAYT.CKSCAYT(t,function(){},function(){})}var n=t.window&&t.window.getFrame()||t.editable();if(n){var s={lang:t.config.scayt_sLang,container:n.$,customDictionary:t.config.scayt_customDictionaryIds,userDictionaryName:t.config.scayt_userDictionaryName,localization:t.langCode,customer_id:t.config.scayt_customerId,customPunctuation:t.config.scayt_customPunctuation,debug:t.config.scayt_debug,data_attribute_name:e.options.data_attribute_name,misspelled_word_class:e.options.misspelled_word_class,problem_grammar_data_attribute:e.options.problem_grammar_data_attribute,problem_grammar_class:e.options.problem_grammar_class,"options-to-restore":t.config.scayt_disableOptionsStorage,focused:t.editable().hasFocus,ignoreElementsRegex:t.config.scayt_elementsToIgnore,ignoreGraytElementsRegex:t.config.grayt_elementsToIgnore,minWordLength:t.config.scayt_minWordLength,multiLanguageMode:t.config.scayt_multiLanguageMode,multiLanguageStyles:t.config.scayt_multiLanguageStyles,graytAutoStartup:a.state.grayt[t.name],charsToObserve:a.charsToObserve};t.config.scayt_serviceProtocol&&(s.service_protocol=t.config.scayt_serviceProtocol),t.config.scayt_serviceHost&&(s.service_host=t.config.scayt_serviceHost),t.config.scayt_servicePort&&(s.service_port=t.config.scayt_servicePort),t.config.scayt_servicePath&&(s.service_path=t.config.scayt_servicePath),"boolean"==typeof t.config.scayt_ignoreAllCapsWords&&(s["ignore-all-caps-words"]=t.config.scayt_ignoreAllCapsWords),"boolean"==typeof t.config.scayt_ignoreDomainNames&&(s["ignore-domain-names"]=t.config.scayt_ignoreDomainNames),"boolean"==typeof t.config.scayt_ignoreWordsWithMixedCases&&(s["ignore-words-with-mixed-cases"]=t.config.scayt_ignoreWordsWithMixedCases),"boolean"==typeof t.config.scayt_ignoreWordsWithNumbers&&(s["ignore-words-with-numbers"]=t.config.scayt_ignoreWordsWithNumbers);var i;try{i=o(s)}catch(t){e.alarmCompatibilityMessage(),delete s.charsToObserve,i=o(s)}i.subscribe("suggestionListSend",function(t){for(var e={},a=[],o=0;o<t.suggestionList.length;o++)e["word_"+t.suggestionList[o]]||(e["word_"+t.suggestionList[o]]=t.suggestionList[o],a.push(t.suggestionList[o]));CKEDITOR.plugins.scayt.suggestions=a}),i.subscribe("selectionIsChanged",function(e){t.getSelection().isLocked&&t.lockSelection()}),i.subscribe("graytStateChanged",function(e){a.state.grayt[t.name]=e.state}),i.addMarkupHandler&&i.addMarkupHandler(function(e){var a=t.editable(),o=a.getCustomData(e.charName);o&&(o.$=e.node,a.setCustomData(e.charName,o))}),t.scayt=i,t.fire("scaytButtonState",t.readOnly?CKEDITOR.TRISTATE_DISABLED:CKEDITOR.TRISTATE_ON)}else a.state.scayt[t.name]=!1})},destroy:function(t){t.scayt&&t.scayt.destroy(),delete t.scayt,t.fire("scaytButtonState",CKEDITOR.TRISTATE_OFF)},loadScaytLibrary:function(t,e){var a,o=function(){CKEDITOR.fireOnce("scaytReady"),t.scayt||"function"==typeof e&&e(t)};void 0===window.SCAYT||"function"!=typeof window.SCAYT.CKSCAYT?(a=t.config.scayt_srcUrl+"?"+this.onLoadTimestamp,CKEDITOR.scriptLoader.load(a,function(t){t&&o()})):window.SCAYT&&"function"==typeof window.SCAYT.CKSCAYT&&o()}},CKEDITOR.on("dialogDefinition",function(t){var e=t.data.name,a=t.data.definition.dialog;"scaytDialog"===e&&a.on("cancel",function(t){return!1},this,null,-1),"checkspell"===e&&a.on("cancel",function(t){var e=t.sender&&t.sender.getParentEditor(),a=CKEDITOR.plugins.scayt,o=e.scayt;o&&a.state.scayt[e.name]&&o.setMarkupPaused&&o.setMarkupPaused(!1),e.unlockSelection()},this,null,-2),"link"===e&&a.on("ok",function(t){var e=t.sender&&t.sender.getParentEditor();e&&setTimeout(function(){e.fire("reloadMarkupScayt",{removeOptions:{removeInside:!0,forceBookmark:!0},timeout:0})},0)})}),CKEDITOR.on("scaytReady",function(){if(!0===CKEDITOR.config.scayt_handleCheckDirty){var t=CKEDITOR.editor.prototype;t.checkDirty=CKEDITOR.tools.override(t.checkDirty,function(t){return function(){var e=null,a=CKEDITOR.plugins.scayt&&CKEDITOR.plugins.scayt.state.scayt[this.name]&&this.scayt,o=this.scayt;if(a){if(e="ready"==this.status){var n=o.removeMarkupFromString(this.getSnapshot()),s=o.removeMarkupFromString(this._.previousValue);e=e&&s!==n}}else e=t.call(this);return e}}),t.resetDirty=CKEDITOR.tools.override(t.resetDirty,function(t){return function(){var e=CKEDITOR.plugins.scayt&&CKEDITOR.plugins.scayt.state.scayt[this.name]&&this.scayt,a=this.scayt;e?this._.previousValue=a.removeMarkupFromString(this.getSnapshot()):t.call(this)}})}if(!0===CKEDITOR.config.scayt_handleUndoRedo){var e=CKEDITOR.plugins.undo.Image.prototype,a="function"==typeof e.equalsContent?"equalsContent":"equals";e[a]=CKEDITOR.tools.override(e[a],function(t){return function(e){var a=CKEDITOR.plugins.scayt&&CKEDITOR.plugins.scayt.state.scayt[e.editor.name]&&e.editor.scayt,o=e.editor.scayt,n=this.contents,s=e.contents,i=null;return a&&(this.contents=o.removeMarkupFromString(n)||"",e.contents=o.removeMarkupFromString(s)||""),i=t.apply(this,arguments),this.contents=n,e.contents=s,i}})}});