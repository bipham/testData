!function(){var t={preserveState:!0,editorFocus:!1,readOnly:1,exec:function(t){this.toggleState(),this.refresh(t)},refresh:function(t){if(t.document){var e=this.state==CKEDITOR.TRISTATE_ON?"attachClass":"removeClass";t.editable()[e]("cke_show_borders")}}};CKEDITOR.plugins.add("showborders",{modes:{wysiwyg:1},onLoad:function(){var t;t=(CKEDITOR.env.ie6Compat?[".%1 table.%2,",".%1 table.%2 td, .%1 table.%2 th","{","border : #d3d3d3 1px dotted","}"]:[".%1 table.%2,",".%1 table.%2 > tr > td, .%1 table.%2 > tr > th,",".%1 table.%2 > tbody > tr > td, .%1 table.%2 > tbody > tr > th,",".%1 table.%2 > thead > tr > td, .%1 table.%2 > thead > tr > th,",".%1 table.%2 > tfoot > tr > td, .%1 table.%2 > tfoot > tr > th","{","border : #d3d3d3 1px dotted","}"]).join("").replace(/%2/g,"cke_show_border").replace(/%1/g,"cke_show_borders "),CKEDITOR.addCss(t)},init:function(e){var r=e.addCommand("showborders",t);r.canUndo=!1,!1!==e.config.startupShowBorders&&r.setState(CKEDITOR.TRISTATE_ON),e.on("mode",function(){r.state!=CKEDITOR.TRISTATE_DISABLED&&r.refresh(e)},null,null,100),e.on("contentDom",function(){r.state!=CKEDITOR.TRISTATE_DISABLED&&r.refresh(e)}),e.on("removeFormatCleanup",function(t){var r=t.data;e.getCommand("showborders").state==CKEDITOR.TRISTATE_ON&&r.is("table")&&(!r.hasAttribute("border")||parseInt(r.getAttribute("border"),10)<=0)&&r.addClass("cke_show_border")})},afterInit:function(t){var e=t.dataProcessor,r=e&&e.dataFilter,o=e&&e.htmlFilter;r&&r.addRules({elements:{table:function(t){var e=t.attributes,r=e.class,o=parseInt(e.border,10);o&&!(o<=0)||r&&-1!=r.indexOf("cke_show_border")||(e.class=(r||"")+" cke_show_border")}}}),o&&o.addRules({elements:{table:function(t){var e=t.attributes,r=e.class;r&&(e.class=r.replace("cke_show_border","").replace(/\s{2}/," ").replace(/^\s+|\s+$/,""))}}})}}),CKEDITOR.on("dialogDefinition",function(t){var e=t.data.name;if("table"==e||"tableProperties"==e){var r=t.data.definition,o=r.getContents("info").get("txtBorder"),a=o.commit;o.commit=CKEDITOR.tools.override(a,function(t){return function(e,r){t.apply(this,arguments);var o=parseInt(this.getValue(),10);r[!o||o<=0?"addClass":"removeClass"]("cke_show_border")}});var s=r.getContents("advanced"),d=s&&s.get("advCSSClasses");d&&(d.setup=CKEDITOR.tools.override(d.setup,function(t){return function(){t.apply(this,arguments),this.setValue(this.getValue().replace(/cke_show_border/,""))}}),d.commit=CKEDITOR.tools.override(d.commit,function(t){return function(e,r){t.apply(this,arguments),parseInt(r.getAttribute("border"),10)||r.addClass("cke_show_border")}}))}})}();