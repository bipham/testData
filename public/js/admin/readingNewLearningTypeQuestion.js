function checkStepAnswer(){return listAnswer={},listKeyword={},list_type_questions={},$(".quiz-learning-"+number_layout+" .last-option").each(function(){var e=$(this).data("qnumber"),t=$(this).attr("name");t=t.match(/\d+/);var n=$(".answer-"+t).val().trim(),s=CKEDITOR.instances["input_explanation_"+e].getData();""!=n?listAnswer[e]=n:delete listAnswer[e],""==s?(s="No_keywords",listClassKeyword[e]="hidden-class"):listClassKeyword[e]="",listKeyword[e]=s,list_type_questions[e]=type_question_id}),listQ.length==Object.keys(listAnswer).length&&listQ.length==Object.keys(list_type_questions).length}var ajaxFinishCreateNewLearningOfTypeQuestion=baseUrl+"/createNewLearningTypeQuestion",ajaxGetAllTypeQuestionByLevelLessonId=baseUrl+"/getTypeQuestionByLevelLessonId",view_layout="",content_section="",left_section="",right_section="",option_list_questions="",level_user_id=1,number_layout=0,title_section="",listAnswer={},listKeyword={},listClassKeyword={},listQ=[],list_type_questions={},listAnswer_source={},listKeyword_source={},list_type_questions_source={},type_question_id="",i="",order_lesson=0,name_icon_section="",content_highlight="",content_answer_quiz="",content_quiz="";$(document).ready(function(){content_section=CKEDITOR.instances.content_section.getData(),left_section=CKEDITOR.instances.left_section.getData(),right_section=CKEDITOR.instances.right_section.getData(),$("#view_layout").on("change",function(){2==(view_layout=$(this).val().trim())?($(".two-layout-content").removeClass("hidden"),$(".first-layout-content").addClass("hidden")):($(".two-layout-content").addClass("hidden"),$(".first-layout-content").removeClass("hidden"))}),$("#list_level").on("change",function(){var e=$(this).val().trim();$.ajax({type:"GET",url:ajaxGetAllTypeQuestionByLevelLessonId,dataType:"json",data:{level_lesson_id:e},success:function(t){$("#list_type_questions").empty(),$("#list_type_questions").append('<option value="'+-e+'">All Of Type</option>'),$.each(t.list_type_questions,function(e,t){$("#list_type_questions").append('<option value="'+t.id+'">'+t.name+"</option>")})},error:function(e){bootbox.alert({message:"FAIL GET ALL TYPE QUESTION!",backdrop:!0})}})}),$(".btn-next-step-second").click(function(){title_section=$("#title_section").val().trim(),type_question_id=$("#list_type_questions").val().trim(),""==title_section?bootbox.alert({message:"Please enter title section!",backdrop:!0}):($(".step-first").addClass("hidden"),$(".step-second").removeClass("hidden"),$("html, body").animate({scrollTop:$(".new-learning-container").offset().top},100))}),$(".btn-prev-step-first").click(function(){$(".step-second").addClass("hidden"),$(".step-first").removeClass("hidden"),$("html, body").animate({scrollTop:$(".new-learning-container").offset().top},100)}),$(".btn-next-step-third").click(function(){1==(number_layout=$("#view_layout").val().trim())?content_section!=CKEDITOR.instances.content_section.getData()&&(content_section=CKEDITOR.instances.content_section.getData(),$("#sandbox-quiz").html(content_section)):left_section==CKEDITOR.instances.left_section.getData()&&right_section==CKEDITOR.instances.right_section.getData()||(left_section=CKEDITOR.instances.left_section.getData(),right_section=CKEDITOR.instances.right_section.getData(),$("#sandbox").html(left_section),$("#quiz-learning").html(right_section)),$(".answer-area").html(""),listQ=[],$(".quiz-learning-"+number_layout+" .question-quiz").each(function(){var e=$(this).data("qnumber");if(-1==jQuery.inArray(e,listQ)){listQ.push(e);var t=$(this).attr("name");t=t.match(/\d+/),$(".answer-area-"+number_layout).append('<div class="answer-key answer-enter-'+e+'" data-qnumber="'+e+'"><h5 class="title-answer-for-question title-custom">Question '+t+':</h5><div class="enter-answer-key row-enter-custom"><div class="title-row-enter">Answer '+t+': </div><input class="answer-q answer-'+t+'" data-qnumber="'+e+'" /></div><div class="enter-keyword row-enter-custom"><div class="title-row-enter">Keyword '+t+': </div><textarea id="input_explanation_'+e+'" class="input-keyword keyword-'+t+'" data-qnumber="'+e+'"></textarea></div><div class="remove-highlight-area-'+t+'"></div></div>'),CKEDITOR.replace("input_explanation_"+e)}-1==jQuery.inArray(e,listAnswer_source)&&($("input.answer-q[data-qnumber="+e+"]").val(listAnswer_source[e]),""==listKeyword_source[e]||void 0==listKeyword_source[e]||null==listKeyword_source[e]?CKEDITOR.instances["input_explanation_"+e].setData(html_table):CKEDITOR.instances["input_explanation_"+e].setData(listKeyword_source[e]),$(".enter-type-question select[data-qnumber="+e+"]").val(list_type_questions_source[e]))}),listQ.length>0?$(".no-question").addClass("hidden-class"):$(".no-question").removeClass("hidden-class"),$(".step-second").addClass("hidden"),$(".step-third").removeClass("hidden"),$("html, body").animate({scrollTop:$(".new-learning-container").offset().top},100)}),$(".btn-prev-step-second").click(function(){$(".step-third").addClass("hidden"),$(".step-second").removeClass("hidden"),$("html, body").animate({scrollTop:$(".new-learning-container").offset().top},100)}),$(".btn-next-step-fourth").click(function(){level_user_id=$("#list_level_users").val().trim(),order_lesson=$("#order_lesson").val().trim();$("#name_icon_section").val().trim();checkStepAnswer()&&0!=order_lesson?(jQuery.isEmptyObject(listAnswer)&&(listAnswer="null",listKeyword="null",list_type_questions="null"),1==number_layout?(content_highlight=$("#sandbox-quiz").html(),$("#pr-quiz-full").html(content_highlight),$(".answer-highlight").addClass("hidden-highlight")):(content_highlight=$("#sandbox").html(),$("#pr-post").html(content_highlight),$(".answer-highlight").addClass("hidden-highlight"),$("#pr-quiz").html(right_section)),$(".step-preview-post").removeClass("hidden"),$(".step-third").addClass("hidden"),console.log("list: "+JSON.stringify(listQ)),listQ.sort(function(e,t){return e-t}),$.each(listQ,function(e,t){if(1==number_layout)n=$('#pr-quiz-full .last-option[data-qnumber="'+t+'"]');else var n=$('#pr-quiz .last-option[data-qnumber="'+t+'"]');var s=n.attr("name");s=s.match(/\d+/);var i=$(".answer-"+s).val();n.parent().append('<div class="explain-area explain-'+s+" explain-area-"+t+'" data-qnumber="'+t+'" data-qorder="'+s+'" data-type-question="'+list_type_questions[t]+'"><div class="show-answer"><button type="button" class="btn btn-danger btn-show-answer">Answer '+s+' <div class="badge badge-pill key-answer">'+i+'</div></button><div class="explain-show" id="explain-'+t+'"> <button type="button" class="btn btn-primary btn-show-explanation show-explanation-'+t+'" data-qnumber="'+t+'" data-qorder="'+s+'" data-type-question="'+list_type_questions[t]+'" onclick="showExplanation('+t+","+s+')"><i class="fa fa-key" aria-hidden="true"></i> Explanation</button><div class="hidden explanation">'+listKeyword[t]+"</div></div></div></div>")}),1==number_layout?($("#pr-quiz-full input").each(function(){$(this).attr("disabled","disabled")}),$("#pr-quiz-full select").each(function(){$(this).attr("disabled","disabled")}),content_answer_quiz=$("#pr-quiz-full").html()):($("#pr-quiz input").each(function(){$(this).attr("disabled","disabled")}),$("#pr-quiz select").each(function(){$(this).attr("disabled","disabled")}),content_answer_quiz=$("#pr-quiz").html(),content_highlight=$("#pr-post").html())):bootbox.alert({message:"Please enter data!",backdrop:!0})}),$(".btn-prev-step-third").click(function(){$(".step-preview-post").addClass("hidden"),$(".step-third").removeClass("hidden"),$("html, body").animate({scrollTop:$(".new-learning-container").offset().top},100)}),$(".btn-create-new-section-type-question").click(function(){$.ajax({type:"POST",url:ajaxFinishCreateNewLearningOfTypeQuestion,dataType:"json",data:{level_user_id:level_user_id,type_question_id:type_question_id,order_lesson:order_lesson,view_layout:number_layout,title:title_section,name_icon_section:name_icon_section,content_section:content_section,left_section:left_section,right_section:right_section,content_answer_quiz:content_answer_quiz,content_highlight:content_highlight,list_answer:listAnswer,list_type_questions:list_type_questions,listKeyword:listKeyword},success:function(e){"fail-step"==e.result?bootbox.alert({message:"Fail! Step section is not available!",backdrop:!0}):"fail-title"==e.result?bootbox.alert({message:"Fail! Title section is not available!",backdrop:!0}):bootbox.alert({message:"Create new learning type question success!",backdrop:!0,callback:function(){location.href=baseUrl+"/createNewLearningTypeQuestion"}})},error:function(e){bootbox.alert({message:"FAIL CREATE NEW learning OF TYPE QUESTION!",backdrop:!0})}})})});